(()=>{const t=document.querySelector("#mainCanvas"),i=t.getContext("2d");t.width=t.clientWidth,t.height=t.clientHeight;const s=i.createLinearGradient(0,0,t.width,t.height);s.addColorStop(0,"white"),s.addColorStop(.5,"lightskyblue"),s.addColorStop(1,"deepskyblue"),i.fillStyle=s,i.strokeStyle="white";class h{constructor(t){this.effect=t,this.radius=Math.floor(4*Math.random()+3),this.x=this.radius+Math.random()*(this.effect.width-2*this.radius),this.x+this.radius>.2*this.effect.width&&this.x-this.radius<.8*this.effect.width?Math.random()<.5?this.y=this.radius+Math.random()*(.2*this.effect.height-2*this.radius):this.y=this.radius+.8*this.effect.height+Math.random()*(.2*this.effect.height-2*this.radius):this.y=this.radius+Math.random()*(this.effect.height-2*this.radius),this.vx=.16*(Math.random()-.5),this.vy=.16*(Math.random()-.5),this.anchorX=this.x,this.anchorY=this.y,this.pullX=0,this.pullY=0,this.pushX=0,this.pushY=0}draw(t){t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fill()}update(){let t=this.calcDistance(this.x,this.y,this.effect.mouse.x,this.effect.mouse.y);if(t.distance<this.effect.mouse.radius){const i=Math.atan2(t.dy,t.dx);this.pushX=.12*Math.cos(i),this.pushY=.12*Math.sin(i)}else this.pushX=0,this.pushY=0;if(t=this.calcDistance(this.x,this.y,this.anchorX,this.anchorY),t.distance>=3*this.radius){const i=Math.atan2(t.dy,t.dx);this.pullX=-.1*Math.cos(i),this.pullY=-.1*Math.sin(i)}else t.distance<.5&&(this.pullX=0,this.pullY=0);this.x+=this.pushX+this.pullX+this.vx,this.y+=this.pushY+this.pullY+this.vy,this.x<this.radius?(this.x=this.radius,this.vx*=-1):this.x>this.effect.width-this.radius&&(this.x=this.effect.width-this.radius,this.vx*=-1),this.y<this.radius?(this.y=this.radius,this.vy*=-1):this.y>this.effect.height-this.radius&&(this.y=this.effect.height-this.radius,this.vy*=-1)}reset(){this.x=this.radius+Math.random()*(this.effect.width-2*this.radius),this.x+this.radius>.2*this.effect.width&&this.x-this.radius<.8*this.effect.width?Math.random()<.5?this.y=this.radius+Math.random()*(.2*this.effect.height-2*this.radius):this.y=this.radius+.8*this.effect.height+Math.random()*(.2*this.effect.height-2*this.radius):this.y=this.radius+Math.random()*(this.effect.height-2*this.radius),this.anchorX=this.x,this.anchorY=this.y}calcDistance(t,i,s,h){const e=t-s,a=i-h;return{dx:e,dy:a,distance:Math.hypot(e,a)}}}class e extends h{constructor(t,i,s){super(t),this.radius=40,this.x=i.x,this.y=i.y,this.anchorX=this.x,this.anchorY=this.y,this.project=s,this.img=new Image,this.img.src=`data:${this.project.imageType};base64,${this.project.image}`}draw(t){i.save(),this.project.premium&&(i.fillStyle="gold"),super.draw(t),i.restore(),this.drawImage(t)}drawImage(t){const i=.85*this.radius*2,s=.85*this.radius*2,h=this.x-i/2,e=this.y-s/2,a=i/2;t.save(),t.beginPath(),t.moveTo(h+a,e),t.arcTo(h+i,e,h+i,e+s,a),t.arcTo(h+i,e+s,h,e+s,a),t.arcTo(h,e+s,h,e,a),t.arcTo(h,e,h+i,e,a),t.closePath(),t.clip(),t.drawImage(this.img,h,e,i,s),t.restore()}reset(t){this.x=this.effect.contentParticleCoordinates[t].x,this.y=this.effect.contentParticleCoordinates[t].y,this.anchorX=this.x,this.anchorY=this.y}}const a=new class{constructor(t,i){this.canvas=t,this.context=i,this.width=this.canvas.width,this.height=this.canvas.height,this.particles=[],this.numberOfParticles=64,this.maxContentParticles=8,this.contentParticleCoordinates=this.calcContentCoordinates(),t.onclick=t=>{this.showContent(t)},this.projects,this.mouse={x:-100,y:-100,radius:100},t.onmousemove=i=>{const s=t.getBoundingClientRect(),h=t.width/s.width,e=t.height/s.height;this.mouse.x=(i.clientX-s.left)*h,this.mouse.y=(i.clientY-s.top)*e},window.onresize=()=>{this.resize(this.canvas.clientWidth,this.canvas.clientHeight)},this.init()}async init(){this.projects=await this.loadProjectsFromServer(),this.createParticles()}loadProjectsFromServer=async()=>{const t=await fetch(`/getRandomProjects?num=${this.maxContentParticles}`);return(await t.json()).projects};createParticles(){for(let t=0;t<this.numberOfParticles;t++)if(t%(this.numberOfParticles/this.maxContentParticles)==0){let i=t/(this.numberOfParticles/this.maxContentParticles);this.projects[i]&&this.particles.push(new e(this,this.contentParticleCoordinates[i],this.projects[i]))}else this.particles.push(new h(this))}handleParticles(t){this.connectParticles(t),this.particles.forEach((i=>{i.draw(t),i.update()}))}connectParticles(t){for(let i=0;i<this.particles.length;i++)for(let s=i;s<this.particles.length;s++){const h=this.particles[i].x-this.particles[s].x,e=this.particles[i].y-this.particles[s].y,a=Math.hypot(h,e);if(a<100){t.save();const h=1-a/100;t.globalAlpha=h,t.beginPath(),t.moveTo(this.particles[i].x,this.particles[i].y),t.lineTo(this.particles[s].x,this.particles[s].y),t.stroke(),t.restore()}}}resize(t,i){this.canvas.width=t,this.canvas.height=i,this.width=t,this.height=i;const s=this.context.createLinearGradient(0,0,t,i);s.addColorStop(0,"white"),s.addColorStop(.5,"lightskyblue"),s.addColorStop(1,"deepskyblue"),this.context.fillStyle=s,this.context.strokeStyle="white",this.contentParticleCoordinates=this.calcContentCoordinates();let h=0;this.particles.forEach((t=>{t instanceof e?(t.reset(h),h++):t.reset()}))}calcContentCoordinates(){return[{x:Math.floor(.4*this.width),y:Math.floor(.65*this.height)},{x:Math.floor(.6*this.width),y:Math.floor(.35*this.height)},{x:Math.floor(.13*this.width),y:Math.floor(.14*this.height)},{x:Math.floor(.88*this.width),y:Math.floor(.7*this.height)},{x:Math.floor(.14*this.width),y:Math.floor(.77*this.height)},{x:Math.floor(.846*this.width),y:Math.floor(.21*this.height)},{x:Math.floor(.3*this.width),y:Math.floor(.4*this.height)},{x:Math.floor(.65*this.width),y:Math.floor(.77*this.height)}]}showContent(i){const s=t.getBoundingClientRect(),h=t.width/s.width,a=t.height/s.height,r=(i.clientX-s.left)*h,o=(i.clientY-s.top)*a,c=document.querySelector("#focusParticle");"flex"!==c.style.display?this.particles.forEach((t=>{if(t instanceof e&&Math.sqrt(Math.pow(r-t.x,2)+Math.pow(o-t.y,2))<=t.radius)return c.style.display="flex",void this.setProjectInfo(t.project)})):c.style.display="none"}setProjectInfo(t){const i=document.querySelector("#focusParticle");if(t.premium?i.style.backgroundImage="radial-gradient(white 30%, gold 90%, rgb(255, 221, 0) 100%)":i.style.backgroundImage="radial-gradient(white 30%, lightskyblue 90%, deepskyblue 100%)",i.querySelector("#focusTitle").innerHTML=t.title,i.querySelector("img").src=`data:${t.imageType};base64,${t.image}`,i.querySelector("#focusDescription").innerHTML=t.description,t.link){const s=i.querySelector("a");s.href=t.link,s.style.visibility="visible"}else i.querySelector("a").style.visibility="hidden";if(i.querySelector("#creator").innerHTML=`<b>Creator: <b>${t.ownerName}`,t.ownerEmail){const s=i.querySelector("#contact");s.innerHTML=`<b>Contact: <b>${t.ownerEmail}`,s.style.visibility="visible"}else i.querySelector("#contact").style.visibility="hidden"}}(t,i);!function s(){i.clearRect(0,0,t.width,t.height),a.handleParticles(i),requestAnimationFrame(s)}()})();